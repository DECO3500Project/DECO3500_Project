const int trigPin1 = 7;
const int echoPin1 = 8;
const int vibOutPin1 = 2;

long duration, cm;
bool vibrationActive = false;

void setup() {
  Serial.begin(9600); // 
  pinMode(trigPin1, OUTPUT);
  pinMode(echoPin1, INPUT);
  pinMode(vibOutPin1, OUTPUT);
}

void loop() {

  long distance1 = readDistance(trigPin1, echoPin1);
  
 
  Serial.print(distance1);
  Serial.println();


  if (Serial.available() > 0) {
    String receivedData = Serial.readStringUntil('\n');
    long distance2 = receivedData.toInt();


    if (distance1 <= 5 && distance2 <= 5) {
      digitalWrite(vibOutPin1, HIGH); // 震动马达启动
      vibrationActive = true;
    } else {
      digitalWrite(vibOutPin1, LOW); // 震动马达关闭
      vibrationActive = false;
    }
  }

  delay(100); // 
}

long readDistance(int trigPin, int echoPin) {
  digitalWrite(trigPin, LOW);
  delayMicroseconds(2);
  digitalWrite(trigPin, HIGH);
  delayMicroseconds(10);
  digitalWrite(trigPin, LOW);
  
  long duration = pulseIn(echoPin, HIGH);
  return microsecondsToCentimeters(duration);
}

long microsecondsToCentimeters(long microseconds) {
  return microseconds / 29 / 2;
}

